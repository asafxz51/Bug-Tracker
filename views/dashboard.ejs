<%- include('partials/header') %>

 <h1>Bug Dashboard</h1>

 <div class="filters">
  <form action="/dashboard" method="GET">
    <div class="selects">
   <select name="severity" onchange="this.form.submit()">
    <option value="">All Severities</option>
    <option value="Critical" <%=query.severity==='Critical' ? 'selected' : '' %>>Critical</option>
    <option value="Major" <%=query.severity==='Major' ? 'selected' : '' %>>Major</option>
    <option value="Medium" <%=query.severity==='Medium' ? 'selected' : '' %>>Medium</option>
    <option value="Minor" <%=query.severity==='Minor' ? 'selected' : '' %>>Minor</option>
    <option value="Trivial" <%=query.severity==='Trivial' ? 'selected' : '' %>>Trivial</option>
   </select>
   <select name="priority" onchange="this.form.submit()">
    <option value="">All Priorities</option>
    <option value="High" <%=query.priority==='High' ? 'selected' : '' %>>High</option>
    <option value="Medium" <%=query.priority==='Medium' ? 'selected' : '' %>>Medium</option>
    <option value="Low" <%=query.priority==='Low' ? 'selected' : '' %>>Low</option>
   </select>
   <select name="status" onchange="this.form.submit()">
    <option value="">All Statuses</option>
    <option value="Open" <%=query.status==='Open' ? 'selected' : '' %>>Open</option>
    <option value="In Progress" <%=query.status==='In Progress' ? 'selected' : '' %>>In Progress</option>
    <option value="Resolved" <%=query.status==='Resolved' ? 'selected' : '' %>>Resolved</option>
    <option value="Closed" <%=query.status==='Closed' ? 'selected' : '' %>>Closed</option>
   </select>
  </div>
  <div class="serach-bar">
   <input type="text" name="search" placeholder="Search..." value="<%= query.search || '' %>">
   <button type="submit" class="btn">Search</button>
   <button href="/dashboard" class="btn">Clear</button>
  </div>
  </form>
 </div>

 <table class="bug-table">
  <thead>
   <tr>
    <th>ID</th>
    <th>Bug Name</th>
    <th>Status</th>
    <th>Severity</th>
    <th>Priority</th>
    <th>Created By</th>
    <th>Assigned To</th>
    <th>Creation Date</th>
   </tr>
  </thead>
  <tbody>
   <% bugs.forEach(bug=> { %>
    <tr onclick="window.location.href='/bugs/<%= bug.id %>'">
     <td>
      <%= bug.id %>
     </td>
     <td>
      <%= bug.bugName %>
     </td>
     <td>
      <span class="status-badge status-<%= bug.status.toLowerCase().replace(' ', '-') %>">
        <%= bug.status %>
      </span>
     </td>
     <td>
      <%= bug.severity %>
     </td>
     <td>
      <%= bug.priority %>
     </td>
     <td>
      <%= bug.createdBy %>
     </td>
     <td>
      <%= bug.assignedTo %>
     </td>
     <td>
      <%= new Date(bug.creationDate).toLocaleDateString() %>
     </td>
    </tr>
    <% }) %>
  </tbody>
 </table>

 <%- include('partials/footer') %>